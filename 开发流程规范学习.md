# 开发流程

### 1 Git commit提交规范

格式:
```
<type>(<scope>): <subject>
<BLANK LINE>
<body>
<BLANK LINE>
<footer>
```
示例:
```
fix: 系统设置初始密码优化

1. 添加眼镜图标,可以切换密码明文的展示和隐藏
2. 添加空格的验证规则,密码字符串中不允许出现空格

BUG地址: http//172.56.4.34:81/zentao/bug-view-740.html
```

`<type>(<scope>): <subject>`: 第一行是commit类型,及提交的标题.

几种常用的type:
1. feat: 新增功能
2. fix: 修复bug
3. docs: 仅修改文档,如READEME等
4. style: 在不改变代码逻辑的情况下,仅仅修改空格,格式缩进,逗号等
5. refactor: 代码重构,没有加新功能或修复bug
6. pref: 优化相关,比如提升性能,体验
7. test: 测试用例,包括单元测试,集成测试等
8. chore: 改变构建流程,或者增加依赖库,工具等
9. revert: 回滚到上一个版本



## 2 基本开发流程
核心流程： 从远端仓库git clone到本地，再在本地开发(commit,add等)，最后push代码至远程仓库。

####多人协作模式具体步骤：
1. 选择一个本地目录新建项目文件夹
![微信截图_20180514160701](https://i.loli.net/2018/05/14/5af943c1453f1.png)

2. 将本地项目文件夹变成本地仓库
git bash进入文件夹目录，使用`git init`指令初始化
![微信截图_20180514160903](https://i.loli.net/2018/05/14/5af944181f183.png)


3. 将本地仓库与远程仓库关联起来（前提远程仓库已经存在，若不存在需要先创建）
![微信图片_20180514161147](https://i.loli.net/2018/05/14/5af944d4b1efb.png)

命令行输入：
```
git remote add origin git@bitbucket.org:nietengfei/demo.git
```

4. 如果不使用默认的master分支开发，则要新建分支（例如dev分支），并且该新建的分支要和远程库的相对应的分支建立关联（因为本地库到最后要和远程库同步）
```
git checkout -b dev origin/dev    //新建本地库dev分支对应
远程库dev分支
```
（如果报错，则使用命令`git fetch origin`，然后再次输入`git checkout -b dev origin/dev`）

5. 上面成功以后，此时已经在dev分支上，克隆远程库里的内容
```
git clone git@bitbucket.org:nietengfei/demo.git
```
![微信截图_20180514164408](https://i.loli.net/2018/05/14/5af94c50347d7.png)

克隆完后本地项目文件夹出现远程库文件

6. 对文件进行操作，然后将修改了的文件从工作区添加到本地库的暂存区
`git add .`

7. 将暂存区的文件提交到本地库
`git commit -am '注释'`

8. 将本地库的分支推送到远程库对应的分支，实现同步（注意要把SSH Key添加到GitHub或者bitbucket）
`git push origin dev`

9. 如果push遇到冲突，则将远程库的新内容pull到本地，再修改完冲突后，重做6-8步

10. 如果pull出错no tracking information，则说明本地分支和远程分支的链接关系没有创建，输入如下命令解决，然后再pull就可以了
`git branch --set-upstream-to=origin/dev dev`


### 总结多人协作工作模式要点：
1. 首先，可以试图用`git push origin branch-name`推送自己的修改；
2. 如果推送失败，则因为远程分支比你的本地更新，需要先用`git pull`试图合并
3. 如果合并有冲突，则解决冲突，并在本地提交
4. 没有冲突或者解决掉冲突后，再用`git push origin branch-name`推送就能成功
如果`git pull`提示`“no tracking information”`，则说明本地分支和远程分支的链接关系没有创建，用命令`git branch --set-upstream branch-name origin/branch-name`。

![微信截图_20180514174228](https://i.loli.net/2018/05/14/5af95a065ca78.png)
> 
> 常用指令：
git remote -v               //查看远程库信息
git checkout branch-name    //切换分支



### 分支操作实战案例：

1. 新建本地文件夹

![QQ截图20180514180921](https://i.loli.net/2018/05/14/5af960444e66c.png)

2. 命令行进入文件目录,初始化为本地仓库
`git init`

3. 绑定远程库
`git remote add origin git@bitbucket.org:nietengfei/test-demo.git`

4. clone项目
`git clone git@bitbucket.org:nietengfei/test-demo.git`

5. 在master分支新建text文件
![微信截图_20180514185556](https://i.loli.net/2018/05/14/5af96b2b0e303.png)

6. 推送到远程库master
![微信截图_20180514185734](https://i.loli.net/2018/05/14/5af96b9270d29.png)

7. 新建并切换至dev分支